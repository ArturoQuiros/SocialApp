import*as e from"react";import{useLayoutEffect as n,useEffect as t,useRef as r}from"react";import{getOverflowAncestors as o,useFloating as u}from"@floating-ui/react-dom";export*from"@floating-ui/react-dom";import{createPortal as c}from"react-dom";import{hideOthers as i}from"aria-hidden";var l="undefined"!=typeof document?n:t;function a(){const e=new Map;return{emit(n,t){var r;null==(r=e.get(n))||r.forEach((e=>e(t)))},on(n,t){e.set(n,[...e.get(n)||[],t])},off(n,t){e.set(n,(e.get(n)||[]).filter((e=>e!==t)))}}}let f=!1,s=0;const d=()=>"floating-ui-"+s++;const v=e["useId".toString()],m=null!=v?v:function(){const[n,t]=e.useState((()=>f?d():void 0));return l((()=>{null==n&&t(d())}),[]),e.useEffect((()=>{f||(f=!0)}),[]),n},g=e.createContext(null),p=e.createContext(null),h=()=>{var n,t;return null!=(n=null==(t=e.useContext(g))?void 0:t.id)?n:null},b=()=>e.useContext(p),y=()=>{const e=m(),n=b(),t=h();return l((()=>{const r={id:e,parentId:t};return null==n||n.addNode(r),()=>{null==n||n.removeNode(r)}}),[n,e,t]),e},E=n=>{let{children:t,id:r}=n;const o=h();return e.createElement(g.Provider,{value:e.useMemo((()=>({id:r,parentId:o})),[r,o])},t)},w=n=>{let{children:t}=n;const r=e.useRef([]),o=e.useCallback((e=>{r.current=[...r.current,e]}),[]),u=e.useCallback((e=>{r.current=r.current.filter((n=>n!==e))}),[]),c=e.useState((()=>a()))[0];return e.createElement(p.Provider,{value:e.useMemo((()=>({nodesRef:r,addNode:o,removeNode:u,events:c})),[r,o,u,c])},t)};function x(e,n,t){const r={};return{..."floating"===t&&{tabIndex:-1},...e,...n.map((e=>e?e[t]:null)).concat(e).reduce(((e,n)=>n?(Object.entries(n).forEach((n=>{let[t,o]=n;0===t.indexOf("on")?(r[t]||(r[t]=[]),"function"==typeof o&&r[t].push(o),e[t]=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];r[t].forEach((e=>e(...n)))}):e[t]=o})),e):e),{})}}const R=function(e){return void 0===e&&(e=[]),{getReferenceProps:n=>x(n,e,"reference"),getFloatingProps:n=>x(n,e,"floating"),getItemProps:n=>x(n,e,"item")}};function k(e){var n;return null!=(n=null==e?void 0:e.ownerDocument)?n:document}function L(e){var n;return null!=(n=k(e).defaultView)?n:window}function T(e){return!!e&&e instanceof L(e).Element}function C(e){return!!e&&e instanceof L(e).HTMLElement}function I(e,n){var t;let r=null!=(t=null==e?void 0:e.nodesRef.current.filter((e=>{var t;return e.parentId===n&&(null==(t=e.context)?void 0:t.open)})))?t:[],o=r;for(;o.length;){var u;o=null!=(u=null==e?void 0:e.nodesRef.current.filter((e=>{var n;return null==(n=o)?void 0:n.some((n=>{var t;return e.parentId===n.id&&(null==(t=e.context)?void 0:t.open)}))})))?u:[],r=r.concat(o)}return r}function A(e){let n,{restMs:t=0,buffer:r=0,debug:o=null}=void 0===e?{}:e,u=!1,c=!1,i=!1;return e=>{let{x:o,y:l,placement:a,refs:f,onClose:s,nodeId:d,tree:v}=e;return function(e){var m;if(clearTimeout(n),!u)return void(i||(i=!0,setTimeout((()=>{u=!0}),1e3/60)));function g(){clearTimeout(n),s()}if(e.pointerType&&"mouse"!==e.pointerType)return;const{clientX:p,clientY:h}=e,b="composedPath"in e?e.composedPath()[0]:e.target;if("pointermove"===e.type&&T(f.reference.current)&&f.reference.current.contains(b))return;if(v&&I(v,d).some((e=>{let{context:n}=e;return null==n?void 0:n.open})))return;if(null!=(m=f.floating.current)&&m.contains(b))return void(c=!0);if(!f.reference.current||!f.floating.current||null==a||null==o||null==l)return;const y=f.reference.current.getBoundingClientRect(),E=f.floating.current.getBoundingClientRect(),w=a.split("-")[0],x=o>E.right-E.width/2,R=l>E.bottom-E.height/2;if("top"===w&&l>=y.bottom-1||"bottom"===w&&l<=y.top+1||"left"===w&&o>=y.right-1||"right"===w&&o<=y.left+1)return g();switch(w){case"top":if(p>=E.left&&p<=E.right&&h>=E.bottom&&h<=y.top)return;break;case"bottom":if(p>=E.left&&p<=E.right&&h>=y.bottom&&h<=E.top)return;break;case"left":if(p>=E.right&&p<=y.left&&h>=E.top&&h<=E.bottom)return;break;case"right":if(p>=y.right&&p<=E.left&&h>=E.top&&h<=E.bottom)return}if(c)return g();const k=function(e){let[n,t]=e;const o=E.width>y.width,u=E.height>y.height;switch(w){case"top":return[[o?n+r/2:x?n+4*r:n-4*r,t+r+1],[o?n-r/2:x?n+4*r:n-4*r,t+r+1],...[[E.left,x||o?E.bottom-r:E.top],[E.right,x?o?E.bottom-r:E.top:E.bottom-r]]];case"bottom":return[[o?n+r/2:x?n+4*r:n-4*r,t-r],[o?n-r/2:x?n+4*r:n-4*r,t-r],...[[E.left,x||o?E.top+r:E.bottom],[E.right,x?o?E.top+r:E.bottom:E.top+r]]];case"left":{const e=[n+r+1,u?t+r/2:R?t+4*r:t-4*r],o=[n+r+1,u?t-r/2:R?t+4*r:t-4*r];return[...[[R||u?E.right-r:E.left,E.top],[R?u?E.right-r:E.left:E.right-r,E.bottom]],e,o]}case"right":return[[n-r,u?t+r/2:R?t+4*r:t-4*r],[n-r,u?t-r/2:R?t+4*r:t-4*r],...[[R||u?E.left+r:E.right,E.top],[R?u?E.left+r:E.right:E.left+r,E.bottom]]]}}([o,l]);!function(e,n){const[t,r]=e;let o=!1;const u=n.length;for(let e=0,c=u-1;e<u;c=e++){const[u,i]=n[e]||[0,0],[l,a]=n[c]||[0,0];i>=r!=a>=r&&t<=(l-u)*(r-i)/(a-i)+u&&(o=!o)}return o}([p,h],k)?g():t&&(n=setTimeout(s,t))}}}const O="floating-ui-root",P=n=>{let{children:t,id:r=O,root:o=null}=n;const[u,i]=e.useState(!1),a=e.useRef(null);return l((()=>{if(o)return;const e=document.getElementById(r);e?a.current=e:(a.current=document.createElement("div"),a.current.id=r),document.body.contains(a.current)||document.body.appendChild(a.current),i(!0)}),[r,o]),o?c(t,o):u&&a.current?c(t,a.current):null};function D(){return D=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},D.apply(this,arguments)}const M="data-floating-ui-scroll-lock",S=e.forwardRef((function(n,t){let{lockScroll:r=!1,...o}=n;return l((()=>{if(!r)return;const e=window.pageXOffset,n=window.pageYOffset,t=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",o=window.innerWidth-document.documentElement.clientWidth;return document.body.hasAttribute(M)?void 0:(Object.assign(document.body.style,{position:"fixed",overflow:"hidden",top:"-"+n+"px",left:"-"+e+"px",right:"0",[t]:o+"px"}),document.body.setAttribute(M,""),()=>{Object.assign(document.body.style,{position:"",overflow:"",top:"",left:"",right:"",[t]:""}),document.body.removeAttribute(M),window.scrollTo(e,n)})}),[r]),e.createElement("div",D({ref:t},o,{style:{position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0,...o.style}}))}));function F(e){let n=e.activeElement;for(;null!=(null==(t=n)||null==(r=t.shadowRoot)?void 0:r.activeElement);){var t,r;n=n.shadowRoot.activeElement}return n}function K(e){e.preventDefault(),e.stopPropagation()}function N(e){const n=r(e);return l((()=>{n.current=e})),n}function j(e){requestAnimationFrame((()=>{null==e||e.focus()}))}const B=e.forwardRef((function(n,t){return e.createElement("span",D({},n,{ref:t,tabIndex:0,style:{position:"fixed",opacity:"0",pointerEvents:"none",outline:"0"}}))}));function U(n){let{context:{refs:t,nodeId:r,onOpenChange:o},children:u,order:c=["content"],endGuard:l=!0,preventTabbing:a=!1,initialFocus:f=0,returnFocus:s=!0,modal:d=!0}=n;const v=N(c),m=N(o),g=b(),p=e.useCallback((()=>v.current.map((e=>{return C(t.reference.current)&&"reference"===e?t.reference.current:t.floating.current&&"floating"===e?t.floating.current:"content"===e?Array.from(null!=(n=null==(r=t.floating.current)?void 0:r.querySelectorAll("input:not([type='hidden']):not([disabled]),select:not([disabled]),textarea:not([disabled]),a[href],button:not([disabled]),[tabindex],iframe,object,embed,area[href],audio[controls],video[controls],[contenteditable]:not([contenteditable='false'])"))?n:[]):null;var n,r})).flat().filter((e=>{if(e===t.floating.current||e===t.reference.current)return!0;if(C(e)){var n;return"-"!==(null!=(n=e.getAttribute("tabindex"))?n:"0")[0].trim()}}))),[v,t.floating,t.reference]);return e.useEffect((()=>{const e=0===p().filter((e=>e!==t.floating.current&&e!==t.reference.current)).length;function n(n){if("Tab"===n.key){(a||e)&&K(n);const r=p(),o="composedPath"in n?n.composedPath()[0]:n.target;"reference"===v.current[0]&&o===t.reference.current&&(K(n),n.shiftKey?j(r[r.length-1]):j(r[1])),"floating"===v.current[1]&&o===t.floating.current&&n.shiftKey&&(K(n),j(r[0]))}}const r=k(t.floating.current);return r.addEventListener("keydown",n),()=>{r.removeEventListener("keydown",n)}}),[a,p,v,t.floating,t.reference]),e.useEffect((()=>{function e(e){var n;const o=e.relatedTarget;null!=(n=t.floating.current)&&n.contains(o)||!T(t.reference.current)||t.reference.current.contains(o)||g&&I(g,r).some((e=>{var n,t;return null==(n=e.context)||null==(t=n.refs.floating.current)?void 0:t.contains(o)}))||m.current(!1)}const n=t.floating.current,o=t.reference.current;if(n&&C(o)){!d&&n.addEventListener("focusout",e);const t=d?i(n):null;return()=>{!d&&n.removeEventListener("focusout",e),null==t||t()}}}),[r,g,d,m,p,f,t.floating,t.reference]),e.useEffect((()=>{var e;if(a)return;const n=t.floating.current,r=null!=(e=F(k(n)))?e:F(document);var o;if("number"==typeof f)j(null!=(o=p()[f])?o:n);else if(C(null==f?void 0:f.current)){var u;j(null!=(u=f.current)?u:n)}return()=>{s&&C(r)&&j(r)}}),[a,p,f,d,s,t.floating]),e.createElement(e.Fragment,null,d&&e.createElement(B,{onFocus:e=>{K(e);const n=p();"reference"===c[0]?j(n[0]):j(n[n.length-1])}}),e.cloneElement(u,c.includes("floating")?{tabIndex:0}:{}),d&&l&&e.createElement(B,{onFocus:e=>{K(e),j(p()[0])}}))}function H(e,n,t){return t&&"mouse"!==t?0:"number"==typeof e?e:null==e?void 0:e[n]}const V=function(n,t){let{enabled:r=!0,delay:o=0,handleClose:u=null,mouseOnly:c=!1,restMs:i=0}=void 0===t?{}:t;const{open:a,onOpenChange:f,dataRef:s,events:d,refs:v}=n,m=b(),g=N(f),p=N(u),h=e.useRef(),y=e.useRef(),E=e.useRef(),w=e.useRef(),x=e.useRef(!0);l((()=>{r&&(a||(h.current=void 0))})),e.useEffect((()=>{if(r)return d.on("dismiss",e),()=>{d.off("dismiss",e)};function e(){clearTimeout(y.current),clearTimeout(w.current),x.current=!0}}),[r,d,v.floating]),e.useEffect((()=>{if(!r||!p.current)return;function e(){var e;null!=(e=s.current.openEvent)&&e.type.includes("mouse")&&g.current(!1)}const n=k(v.floating.current).documentElement;return n.addEventListener("mouseleave",e),()=>{n.removeEventListener("mouseleave",e)}}),[v.floating,g,r,p,s]);const R=e.useCallback((function(e){void 0===e&&(e=!0),o&&!E.current?(clearTimeout(y.current),y.current=setTimeout((()=>g.current(!1)),H(o,"close",h.current))):e&&g.current(!1)}),[o,g]),L=e.useCallback((()=>{E.current&&(k(v.floating.current).removeEventListener("pointermove",E.current),E.current=void 0)}),[v.floating]);if(e.useEffect((()=>{a||L()}),[a,r,L]),e.useEffect((()=>{if(!r)return;function e(e){clearTimeout(y.current),x.current=!1,a||c&&"mouse"!==h.current||i>0&&0===H(o,"open")||(s.current.openEvent=e,o?y.current=setTimeout((()=>{g.current(!0)}),H(o,"open",h.current)):g.current(!0))}function t(e){var t,r;if("click"===(null==(t=s.current.openEvent)?void 0:t.type)||"pointerdown"===(null==(r=s.current.openEvent)?void 0:r.type))return;const o=k(v.floating.current);if(clearTimeout(w.current),p.current)return clearTimeout(y.current),E.current&&o.removeEventListener("pointermove",E.current),E.current=p.current({...n,tree:m,x:e.clientX,y:e.clientY,onClose(){L(),R()}}),void o.addEventListener("pointermove",E.current);R()}const u=v.reference.current;return T(u)?(u.addEventListener("mousemove",e,{once:!0}),u.addEventListener("mouseenter",e),u.addEventListener("mouseleave",t),()=>{u.removeEventListener("mousemove",e),u.removeEventListener("mouseenter",e),u.removeEventListener("mouseleave",t)}):void 0}),[r,R,n,o,p,s,c,g,a,m,i,L,v.reference,v.floating]),!r)return{};function C(e){h.current=e.pointerType}return{reference:{onPointerDown:C,onPointerEnter:C,onMouseMove(){a||0===i||(clearTimeout(w.current),w.current=setTimeout((()=>{x.current||f(!0)}),i))}},floating:{onMouseEnter(){clearTimeout(y.current)},onMouseLeave:()=>R(!1)}}},X=e.createContext({delay:1e3,initialDelay:1e3,currentId:null,setCurrentId:()=>{},setState:()=>{}}),Y=()=>e.useContext(X),q=n=>{let{children:t,delay:r}=n;const[o,u]=e.useState({delay:r,initialDelay:r,currentId:null}),c=e.useCallback((e=>{u((n=>({...n,currentId:e})))}),[]);return e.createElement(X.Provider,{value:e.useMemo((()=>({...o,setState:u,setCurrentId:c})),[o,u,c])},t)},W=(n,t)=>{let{open:r,onOpenChange:o}=n,{id:u}=t;const{currentId:c,initialDelay:i,setState:l}=Y(),a=N(o);e.useEffect((()=>{c&&a.current&&(l((e=>({...e,delay:{open:1,close:H(i,"close")}}))),c!==u&&a.current(!1))}),[u,a,l,c,i]),e.useEffect((()=>{!r&&c===u&&a.current&&(a.current(!1),l((e=>({...e,delay:i,currentId:null}))))}),[r,l,c,u,a,i])},z=function(e,n){let{open:t}=e,{enabled:r=!0,role:o="dialog"}=void 0===n?{}:n;const u=m(),c=m(),i={id:u,role:o};return r?"tooltip"===o?{reference:{"aria-describedby":t?u:void 0},floating:i}:{reference:{"aria-expanded":t?"true":"false","aria-haspopup":o,"aria-controls":t?u:void 0,..."listbox"===o&&{role:"combobox"},..."menu"===o&&{id:c}},floating:{...i,..."menu"===o&&{"aria-labelledby":c}}}:{}},G=function(n,t){let{open:r,onOpenChange:o,dataRef:u,refs:c}=n,{enabled:i=!0,pointerDown:l=!1,toggle:a=!0,ignoreMouse:f=!1}=void 0===t?{}:t;const s=e.useRef();function d(){return C(c.reference.current)&&"BUTTON"===c.reference.current.tagName}return i?{reference:{onPointerDown(e){if(s.current=e.pointerType,("mouse"!==s.current||!f)&&l){var n;if(r)a&&"pointerdown"===(null==(n=u.current.openEvent)?void 0:n.type)&&o(!1);else o(!0);u.current.openEvent=e.nativeEvent}},onClick(e){if(l&&s.current)s.current=void 0;else if("mouse"!==s.current||!f){var n;if(r)a&&"click"===(null==(n=u.current.openEvent)?void 0:n.type)&&o(!1);else o(!0);u.current.openEvent=e.nativeEvent}},onKeyDown(e){d()||(" "===e.key&&e.preventDefault(),"Enter"===e.key&&(r?a&&o(!1):o(!0)))},onKeyUp(e){d()||" "===e.key&&(r?a&&o(!1):o(!0))}}}:{}};function J(e,n){if(null==n)return!1;if("composedPath"in e)return e.composedPath().includes(n);const t=e;return null!=t.target&&n.contains(t.target)}const Q=function(n,t){let{open:r,onOpenChange:u,refs:c,events:i,nodeId:l}=n,{enabled:a=!0,escapeKey:f=!0,outsidePointerDown:s=!0,referencePointerDown:d=!1,ancestorScroll:v=!1,bubbles:m=!0}=void 0===t?{}:t;const g=b(),p=N(u),h=e.useCallback((()=>{var e;return null==(e=c.floating.current)?void 0:e.contains(F(k(c.floating.current)))}),[c.floating]),y=e.useCallback((()=>{C(c.reference.current)&&c.reference.current.focus()}),[c.reference]);return e.useEffect((()=>{if(!r||!a)return;function e(e){if("Escape"===e.key){if(!m&&!h())return;i.emit("dismiss"),p.current(!1),y()}}function n(e){const n=g&&I(g,l).some((n=>{var t;return J(e,null==(t=n.context)?void 0:t.refs.floating.current)}));J(e,c.floating.current)||T(c.reference.current)&&J(e,c.reference.current)||n||(m||h())&&(i.emit("dismiss"),p.current(!1),y())}function t(){p.current(!1)}const u=k(c.floating.current);f&&u.addEventListener("keydown",e),s&&u.addEventListener("mousedown",n);const d=(v?[...T(c.reference.current)?o(c.reference.current):[],...T(c.floating.current)?o(c.floating.current):[]]:[]).filter((e=>{var n;return e!==(null==(n=u.defaultView)?void 0:n.visualViewport)}));return d.forEach((e=>e.addEventListener("scroll",t,{passive:!0}))),()=>{f&&u.removeEventListener("keydown",e),s&&u.removeEventListener("mousedown",n),d.forEach((e=>e.removeEventListener("scroll",t)))}}),[f,s,i,g,l,r,p,y,v,a,m,h,c.floating,c.reference]),a?{reference:{onPointerDown(){d&&(i.emit("dismiss"),u(!1))}}}:{}},Z=function(n,t){let{open:r,onOpenChange:o,dataRef:u,refs:c,events:i}=n,{enabled:l=!0,keyboardOnly:a=!0}=void 0===t?{}:t;const f=e.useRef(!1);return e.useEffect((()=>{var e;if(!l)return;const n=null!=(e=k(c.floating.current).defaultView)?e:window;function t(){f.current=!r}function o(){setTimeout((()=>{f.current=!1}))}return n.addEventListener("focus",o),n.addEventListener("blur",t),()=>{n.removeEventListener("focus",o),n.removeEventListener("blur",t)}}),[c.floating,r,l]),e.useEffect((()=>{if(l)return i.on("dismiss",e),()=>{i.off("dismiss",e)};function e(){f.current=!0}}),[i,l]),l?{reference:{onPointerDown(e){let{pointerType:n}=e;f.current=!(!n||!a)},onFocus(e){var n,t,r;f.current||"focus"===e.type&&"mousedown"===(null==(n=u.current.openEvent)?void 0:n.type)&&T(c.reference.current)&&null!=(t=c.reference.current)&&t.contains(null==(r=u.current.openEvent)?void 0:r.target)||(u.current.openEvent=e.nativeEvent,o(!0))},onBlur(e){var n;const t=e.relatedTarget;null!=(n=c.floating.current)&&n.contains(t)||T(c.reference.current)&&c.reference.current.contains(t)||(f.current=!1,o(!1))}}}:{}};function $(e,n){let{startingIndex:t=-1,decrement:r=!1}=void 0===n?{}:n;const o=e.current;let u=t;do{var c,i;u+=r?-1:1}while(u>=0&&u<=o.length-1&&(null==o[u]||null!=(c=o[u])&&c.hasAttribute("disabled")||"true"===(null==(i=o[u])?void 0:i.getAttribute("aria-disabled"))));return u}function _(e,n,t){switch(e){case"vertical":return n;case"horizontal":return t;default:return n||t}}function ee(e,n){return _(n,"ArrowUp"===e||"ArrowDown"===e,"ArrowLeft"===e||"ArrowRight"===e)}function ne(e,n,t){return _(n,"ArrowDown"===e,t?"ArrowLeft"===e:"ArrowRight"===e)}function te(e){return $(e)}function re(e){return $(e,{decrement:!0,startingIndex:e.current.length})}const oe=function(n,t){let{open:o,onOpenChange:u,refs:c}=n,{listRef:i,activeIndex:a,onNavigate:f,enabled:s=!0,selectedIndex:d=null,allowEscape:v=!1,loop:m=!1,nested:g=!1,rtl:p=!1,virtual:y=!1,focusItemOnOpen:E="auto",focusItemOnHover:w=!0,orientation:x="vertical"}=void 0===t?{listRef:{current:[]},activeIndex:null,onNavigate:()=>{}}:t;const R=h(),L=b(),T=function(e){const n=r();return l((()=>{n.current=e}),[e]),n.current}(o),I=e.useRef("auto"!==E&&E),A=e.useRef(null!=d?d:-1),O=e.useRef(""),P=N(f),D=e.useRef(!1),[M,S]=e.useState(),j=e.useCallback(((e,n)=>{var t,r;y?S(null==(t=e.current[n.current])?void 0:t.id):null==(r=e.current[n.current])||r.focus({preventScroll:!0})}),[y]);function B(e){if(D.current=!0,g&&function(e,n,t){return _(n,t?"ArrowRight"===e:"ArrowLeft"===e,"ArrowUp"===e)}(e.key,x,p))return K(e),u(!1),void(C(c.reference.current)&&c.reference.current.focus());const n=A.current,t=te(i),r=re(i);if("Home"===e.key&&(A.current=t,f(A.current)),"End"===e.key&&(A.current=r,f(A.current)),ee(e.key,x)){if(K(e),!y&&F(e.currentTarget.ownerDocument)===e.currentTarget)return A.current=null!=d?d:ne(e.key,x,p)?t:r,void f(A.current);ne(e.key,x,p)?A.current=m?n>=r?v&&n!==i.current.length?-1:t:$(i,{startingIndex:n}):Math.min(r,$(i,{startingIndex:n})):A.current=m?n<=t?v&&-1!==n?i.current.length:r:$(i,{startingIndex:n,decrement:!0}):Math.max(t,$(i,{startingIndex:n,decrement:!0})),f(A.current)}}return l((()=>{s&&(null!=d&&(A.current=d),!T&&o&&I.current&&(P.current(A.current),j(i,A)))}),[o,T,d,i,P,j,s]),l((()=>{s&&o&&(null==a?(!T&&I.current&&null==d||v)&&(A.current=v?-1:te(i),P.current(a),j(i,A)):(A.current=a,P.current(a),j(i,A)))}),[o,T,a,d,g,i,P,j,s,R,v,c.floating,null==L?void 0:L.nodesRef]),l((()=>{if(null==d&&s){if(o&&(ee(O.current,x)||I.current&&(" "===O.current||"Enter"===O.current))){const e=te(i),n=re(i);A.current=function(e,n,t){return _(n,"ArrowUp"===e,t?"ArrowRight"===e:"ArrowLeft"===e)}(O.current,x,p)?v?i.current.length:n:v?-1:e,P.current(A.current),j(i,A)}O.current=""}}),[o,i,d,P,j,s,x,p,v]),l((()=>{s&&!o&&T&&null!=d&&C(c.reference.current)&&c.reference.current.focus()}),[c.reference,d,o,T,s]),l((()=>{var e;s&&(o||(A.current=null!=(e=null!=d?d:a)?e:-1,P.current(null)))}),[o,d,a,s,E,P]),l((()=>{if(s&&!o&&T){var e,n;const t=null==L||null==(e=L.nodesRef.current.find((e=>e.id===R)))||null==(n=e.context)?void 0:n.refs.floating.current;t&&!t.contains(F(k(t)))&&t.focus({preventScroll:!0})}}),[s,o,T,L,R]),l((()=>{I.current=!1,O.current=""})),s?{reference:{...y&&o&&null!=a&&{"aria-activedescendant":M},onKeyDown(e){if(D.current=!0,y&&o)return B(e);"auto"===E&&(I.current=!0),O.current=e.key,g?function(e,n,t){return _(n,t?"ArrowLeft"===e:"ArrowRight"===e,"ArrowDown"===e)}(e.key,x,p)&&(K(e),o?(A.current=te(i),f(A.current)):u(!0)):(ee(e.key,x)&&(A.current=null==d?ne(e.key,x,p)?te(i):re(i):d,K(e),u(!0),f(A.current)),y&&!o&&B(e))}},floating:{"aria-orientation":"both"===x?void 0:x,...y&&null!=a&&{"aria-activedescendant":M},onKeyDown:B,onPointerMove(){D.current=!1}},item:{onFocus(e){let{currentTarget:n}=e;const t=i.current.indexOf(n);-1!==t&&f(t)},onClick:e=>{let{currentTarget:n}=e;return n.focus({preventScroll:!0})},...w&&{onPointerMove(e){let{currentTarget:n}=e;const t=n;if(t){const e=i.current.indexOf(t);-1!==e&&f(e)}},onPointerLeave(){var e;D.current||(f(null),y?(A.current=-1,j(i,A)):null==(e=c.floating.current)||e.focus({preventScroll:!0}))}}}}:{}},ue=function(n,t){var r;let{open:o,dataRef:u}=n,{listRef:c,activeIndex:i,onMatch:a=(()=>{}),enabled:f=!0,findMatch:s=null,resetMs:d=1e3,ignoreKeys:v=[],selectedIndex:m=null}=void 0===t?{listRef:{current:[]},activeIndex:null}:t;const g=e.useRef(),p=e.useRef(""),h=e.useRef(null!=(r=null!=m?m:i)?r:-1),b=e.useRef(null);function y(e){if(!e.currentTarget.contains(F(k(e.currentTarget))))return;p.current.length>0&&" "!==p.current[0]&&(u.current.typing=!0," "===e.key&&K(e));const n=c.current;if(null==n||["Home","End","Escape","Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight",...v].includes(e.key))return;n.every((e=>{var n,t;return!e||(null==(n=e[0])?void 0:n.toLocaleLowerCase())!==(null==(t=e[1])?void 0:t.toLocaleLowerCase())}))&&p.current===e.key&&(p.current="",h.current=b.current),p.current+=e.key,clearTimeout(g.current),g.current=setTimeout((()=>{p.current="",h.current=b.current,u.current.typing=!1}),d);const t=h.current,r=[...n.slice((null!=t?t:0)+1),...n.slice(0,(null!=t?t:0)+1)],o=s?s(r,p.current):r.find((e=>0===(null==e?void 0:e.toLocaleLowerCase().indexOf(p.current)))),i=o?n.indexOf(o):-1;-1!==i&&(a(i),b.current=i)}return l((()=>{o&&(clearTimeout(g.current),b.current=null,p.current="")}),[o]),l((()=>{var e;o&&""===p.current&&(h.current=null!=(e=null!=m?m:i)?e:-1)}),[o,m,i]),f?{reference:{onKeyDown:y},floating:{onKeyDown:y}}:{}};function ce(n){let{open:t=!1,onOpenChange:r=(()=>{}),placement:o,middleware:c,strategy:i,nodeId:f}=void 0===n?{}:n;const s=b(),d=e.useRef({}),v=e.useState((()=>a()))[0],m=u({placement:o,middleware:c,strategy:i}),g=e.useMemo((()=>({...m,dataRef:d,nodeId:f,events:v,open:t,onOpenChange:r})),[m,d,f,v,t,r]);return l((()=>{const e=null==s?void 0:s.nodesRef.current.find((e=>e.id===f));e&&(e.context=g)})),e.useMemo((()=>({context:g,...m})),[m,g])}export{q as FloatingDelayGroup,U as FloatingFocusManager,E as FloatingNode,S as FloatingOverlay,P as FloatingPortal,w as FloatingTree,A as safePolygon,G as useClick,W as useDelayGroup,Y as useDelayGroupContext,Q as useDismiss,ce as useFloating,y as useFloatingNodeId,h as useFloatingParentNodeId,b as useFloatingTree,Z as useFocus,V as useHover,m as useId,R as useInteractions,oe as useListNavigation,z as useRole,ue as useTypeahead};
